@function [pottarg,gradtarg] = hfmm2d(eps,zk,srcinfo,targ)
    charges = srcinfo.charges;
    dipstr = srcinfo.dipstr;
    dipvec = srcinfo.dipvec;
    sources = srcinfo.sources;
    [~,ns] = size(sources);
    [~,nt] = size(targ);
    pottarg = complex(zeros(1,nt));
    gradtarg = complex(zeros(2,nt));
    ier = 0;
    
    # FORTRAN hfmm2d_t_cd_g(double[1] eps, dcomplex[1] zk, int[1] ns, double[2,ns] sources, dcomplex[ns] charges, dcomplex[ns] dipstr, double[2,ns] dipvec, int[1] nt, double[2,nt] targ, inout dcomplex[nt] pottarg,inout dcomplex[2,nt] gradtarg, inout int[1] ier);
    pottarg = reshape(pottarg,[1,nt]);
    gradtarg = reshape(gradtarg, [2,nt]);

end



@function [pottarg] = cfmm2d(eps,srcinfo,targ)
    dipstr = srcinfo.dipstr;
    sources = srcinfo.sources;
    [~,ns] = size(sources);
    [~,nt] = size(targ);
    ier = 0;
    pottarg = complex(zeros(1,nt));

    # FORTRAN cfmm2d_t_d_p(double[1] eps, int[1] ns, double[2,ns] sources, dcomplex[ns] dipstr, int[1] nt, double[2,nt] targ, inout dcomplex[nt] pottarg, inout int[1] ier);
    pottarg = reshape(pottarg,[1,nt]);
end



@function [pottarg] = c2ddir(eps,srcinfo,targ)
    nd = 1;
    dipstr = srcinfo.dipstr;
    sources = srcinfo.sources;
    [~,ns] = size(sources);
    [~,nt] = size(targ);
    ier = 0;
    thresh = 1e-16;
    pottarg = complex(zeros(1,nt));
    # FORTRAN c2d_directdp(int[1] nd, double[2,ns] sources, int[1] ns, dcomplex[nd,ns] dipstr, double[2,nt] targ, int[1] nt, inout dcomplex[nd,nt] pottarg, double[1] thresh);
    pottarg = reshape(pottarg,[1,nt]);
     
end



@function [pottarg,gradtarg] = h2ddir(eps,zk,srcinfo,targ)
    nd = 1;
    charges = srcinfo.charges;
    dipstr = srcinfo.dipstr;
    dipvec = srcinfo.dipvec;
    sources = srcinfo.sources;
    [~,ns] = size(sources);
    [~,nt] = size(targ);
    pottarg = complex(zeros(1,nt));
    gradtarg = complex(zeros(2,nt));
    ier = 0;
    nd2 = 2*nd;
    thresh = 1e-16;
    
    # FORTRAN h2d_directcdg(int[1] nd, dcomplex[1] zk, double[2,ns] sources, int[1] ns, dcomplex[nd,ns] charges, dcomplex[nd,ns] dipstr, double[nd2,ns] dipvec, double[2,nt] targ, int[1] nt, inout dcomplex [nd,nt] pottarg, inout dcomplex[nd2,nt] gradtarg, double[1] thresh);
    pottarg = reshape(pottarg,[1,nt]);
    gradtarg = reshape(gradtarg, [2,nt]);
    
end
